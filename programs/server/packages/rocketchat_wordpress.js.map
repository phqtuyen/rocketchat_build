{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:wordpress/common.js","meteor://ðŸ’»app/packages/rocketchat:wordpress/startup.js"],"names":["config","serverURL","identityPath","identityTokenSentVia","authorizePath","tokenPath","scope","addAutopublishFields","forLoggedInUser","forOtherUsers","WordPress","CustomOAuth","Meteor","isServer","startup","RocketChat","settings","get","key","value","configure","Tracker","autorun","addGroup","section","enableQuery","_id","add","type","readonly","force"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA,MAAMA,SAAS;AACdC,aAAW,EADG;AAEdC,gBAAc,aAFA;AAGdC,wBAAsB,QAHR;AAIdC,iBAAe,mBAJD;AAKdC,aAAW,eALG;AAMdC,SAAO,MANO;AAOdC,wBAAsB;AACrBC,qBAAiB,CAAC,oBAAD,CADI;AAErBC,mBAAe,CAAC,+BAAD;AAFM;AAPR,CAAf;AAaA,MAAMC,YAAY,IAAIC,WAAJ,CAAgB,WAAhB,EAA6BX,MAA7B,CAAlB;;AAEA,IAAIY,OAAOC,QAAX,EAAqB;AACpBD,SAAOE,OAAP,CAAe,YAAW;AACzB,WAAOC,WAAWC,QAAX,CAAoBC,GAApB,CAAwB,mBAAxB,EAA6C,UAASC,GAAT,EAAcC,KAAd,EAAqB;AACxEnB,aAAOC,SAAP,GAAmBkB,KAAnB;AACA,aAAOT,UAAUU,SAAV,CAAoBpB,MAApB,CAAP;AACA,KAHM,CAAP;AAIA,GALD;AAMA,CAPD,MAOO;AACNY,SAAOE,OAAP,CAAe,YAAW;AACzB,WAAOO,QAAQC,OAAR,CAAgB,YAAW;AACjC,UAAIP,WAAWC,QAAX,CAAoBC,GAApB,CAAwB,mBAAxB,CAAJ,EAAkD;AACjDjB,eAAOC,SAAP,GAAmBc,WAAWC,QAAX,CAAoBC,GAApB,CAAwB,mBAAxB,CAAnB;AACA,eAAOP,UAAUU,SAAV,CAAoBpB,MAApB,CAAP;AACA;AACD,KALM,CAAP;AAMA,GAPD;AAQA,C;;;;;;;;;;;ACjCDe,WAAWC,QAAX,CAAoBO,QAApB,CAA6B,OAA7B,EAAsC,YAAW;AAChD,SAAO,KAAKC,OAAL,CAAa,WAAb,EAA0B,YAAW;AAE3C,UAAMC,cAAc;AACnBC,WAAK,0BADc;AAEnBP,aAAO;AAFY,KAApB;AAIA,SAAKQ,GAAL,CAAS,0BAAT,EAAqC,KAArC,EAA4C;AAC3CC,YAAM,SADqC;AAE3C,gBAAU;AAFiC,KAA5C;AAIA,SAAKD,GAAL,CAAS,mBAAT,EAA8B,EAA9B,EAAkC;AACjCC,YAAM,QAD2B;AAEjCH,iBAFiC;AAGjC,gBAAU;AAHuB,KAAlC;AAKA,SAAKE,GAAL,CAAS,6BAAT,EAAwC,EAAxC,EAA4C;AAC3CC,YAAM,QADqC;AAE3CH;AAF2C,KAA5C;AAIA,SAAKE,GAAL,CAAS,iCAAT,EAA4C,EAA5C,EAAgD;AAC/CC,YAAM,QADyC;AAE/CH;AAF+C,KAAhD;AAIA,WAAO,KAAKE,GAAL,CAAS,uCAAT,EAAkD,kBAAlD,EAAsE;AAC5EC,YAAM,aADsE;AAE5EC,gBAAU,IAFkE;AAG5EC,aAAO,IAHqE;AAI5EL;AAJ4E,KAAtE,CAAP;AAMA,GA7BM,CAAP;AA8BA,CA/BD,E","file":"/packages/rocketchat_wordpress.js","sourcesContent":["/* globals CustomOAuth */\n\nconst config = {\n\tserverURL: '',\n\tidentityPath: '/rest/v1/me',\n\tidentityTokenSentVia: 'header',\n\tauthorizePath: '/oauth2/authorize',\n\ttokenPath: '/oauth2/token',\n\tscope: 'auth',\n\taddAutopublishFields: {\n\t\tforLoggedInUser: ['services.wordpress'],\n\t\tforOtherUsers: ['services.wordpress.user_login']\n\t}\n};\n\nconst WordPress = new CustomOAuth('wordpress', config);\n\nif (Meteor.isServer) {\n\tMeteor.startup(function() {\n\t\treturn RocketChat.settings.get('API_Wordpress_URL', function(key, value) {\n\t\t\tconfig.serverURL = value;\n\t\t\treturn WordPress.configure(config);\n\t\t});\n\t});\n} else {\n\tMeteor.startup(function() {\n\t\treturn Tracker.autorun(function() {\n\t\t\tif (RocketChat.settings.get('API_Wordpress_URL')) {\n\t\t\t\tconfig.serverURL = RocketChat.settings.get('API_Wordpress_URL');\n\t\t\t\treturn WordPress.configure(config);\n\t\t\t}\n\t\t});\n\t});\n}\n","RocketChat.settings.addGroup('OAuth', function() {\n\treturn this.section('WordPress', function() {\n\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Wordpress',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Wordpress', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('API_Wordpress_URL', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Wordpress_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Wordpress_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Wordpress_callback_url', '_oauth/wordpress', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n});\n"]}